# 自动控制功能提示与推荐建议 - 实施方案

## 目标概述

为 Settings.vue「自动控制」面板中全部 **19 个功能项**（18 个开关 + 1 个施肥策略下拉）增加鼠标悬停 Tooltip，展示功能解释和推荐开关建议。

---

## 一、功能清单与推荐建议（全部 19 项）

### 🌾 农场基础操作（5 项）

| # | 功能名 | 数据键 | 功能解释 | 推荐 |
|---|--------|--------|---------|------|
| 1 | 自动种植收获 | `farm` | 核心总开关。自动巡查农场：成熟即收、空地即种、异常即处理（浇水/除草/除虫/铲除枯死）。关闭后所有农场自动化停止 | ✅ 推荐开启 |
| 2 | 自动好友互动 | `friend` | 好友巡查总开关。开启后按下方子策略自动遍历好友农场执行操作。关闭则所有好友互动（偷菜/帮忙/捣乱）停止 | ✅ 推荐开启 |
| 3 | 自动升级土地 | `land_upgrade` | 当金币充足且土地满足升级条件时，自动升级土地等级。升级可提高产量和种植容量 | ⚠️ 看需求（升级需花费大量金币，金币紧张时建议关闭） |
| 4 | 自动卖果实 | `sell` | 收获后自动将仓库中的果实出售到商店换取金币。关闭则果实堆积在仓库不处理 | ✅ 推荐开启 |
| 5 | 推送触发巡田 | `farm_push` | 收到下线推送、QQ消息等外部事件时，立即触发一次农场巡查，而非等待定时轮询。提高响应灵敏度 | ✅ 推荐开启 |

### 🎁 每日收益领取（7 项）

| # | 功能名 | 数据键 | 功能解释 | 推荐 |
|---|--------|--------|---------|------|
| 6 | 自动商城礼包 | `free_gifts` | 每日自动领取商城中的免费礼包（种子/化肥/装饰等），错过后次日才能再领 | ✅ 推荐开启 |
| 7 | 自动完成任务 | `task` | 自动完成每日任务并领取任务奖励（金币/经验/道具），是经验和金币的重要来源 | ✅ 推荐开启 |
| 8 | 自动分享奖励 | `share_reward` | 自动触发分享操作并领取分享奖励。有的活动需要分享才能获取额外奖励 | ✅ 推荐开启 |
| 9 | 自动领取邮件 | `email` | 自动领取系统邮件中的附件奖励（活动奖励/补偿/系统礼品等） | ✅ 推荐开启 |
| 10 | 自动VIP礼包 | `vip_gift` | VIP 用户专属。自动领取每日 VIP 礼包奖励，非 VIP 用户开启无效但不报错 | ⚠️ 有 VIP 则开 |
| 11 | 自动月卡奖励 | `month_card` | 月卡用户专属。自动领取月卡每日奖励，无月卡开启无效但不报错 | ⚠️ 有月卡则开 |
| 12 | 自动开服红包 | `open_server_gift` | 自动领取开服活动红包奖励。活动期间有效，非活动期开启无影响 | ✅ 推荐开启 |

### 🧪 化肥与精细控制（4 项）

| # | 功能名 | 数据键 | 功能解释 | 推荐 |
|---|--------|--------|---------|------|
| 13 | 自动填充化肥 | `fertilizer_gift` | 有免费化肥领取机会时自动领取，保证化肥库存不断档 | ✅ 推荐开启 |
| 14 | 自动购买化肥 | `fertilizer_buy` | 化肥库存不足时自动花费金币购买。注意：会持续消耗金币 | ⚠️ 金币充足则开 |
| 15 | 60秒施肥(防偷) | `fertilizer_60s_anti_steal` | 核心防盗功能。在果实成熟前 60 秒内自动施肥催熟并瞬间收获，将被偷窗口压缩到接近 0。需要消耗化肥 | ✅ 推荐开启（主号必开） |
| 16 | 施肥策略 | `fertilizer` | 选择种植后的施肥方式：普通肥加速生长、有机肥改善土壤、两者兼用、或不施肥 | ⚠️ 推荐「普通+有机」或「仅普通」 |

### 👥 社交互动详细策略（5 项）

| # | 功能名 | 数据键 | 功能解释 | 推荐 |
|---|--------|--------|---------|------|
| 17 | 自动偷菜 | `friend_steal` | 访问好友农场时自动偷取成熟果实。是金币收入的重要补充来源 | ✅ 推荐开启 |
| 18 | 自动帮忙 | `friend_help` | 访问好友农场时自动帮忙浇水/除草/除虫。可获得经验奖励 | ✅ 推荐开启 |
| 19 | 自动捣乱 | `friend_bad` | 访问好友农场时自动放虫/放草，给好友添麻烦。有社交风险（好友可能拉黑） | ❌ 推荐关闭（除非小号） |
| 20 | 自动同意好友 | `friend_auto_accept` | 自动同意所有好友申请。好友越多偷菜机会越多，但也增加被偷风险 | ⚠️ 看需求 |
| 21 | 经验上限停止帮忙 | `friend_help_exp_limit` | 当日帮忙经验达到系统上限后自动停止帮忙，避免做无用功浪费请求次数 | ✅ 推荐开启 |

---

## 二、技术实现方案

### 方案选择：增强 BaseSwitch 组件 + 原生 title + CSS Tooltip

考虑到项目不依赖第三方 Tooltip 库，采用**原生 `title` 属性 + 自定义 CSS Tooltip** 双重方案：
- 原生 `title`：零依赖，所有浏览器天然支持
- 追加可选的 `hint` prop，当存在时在 label 旁显示一个小 `?` 图标 + CSS tooltip

### 涉及文件

#### [MODIFY] [BaseSwitch.vue](file:///Volumes/My Shared Files/AllFiles/Users/smdk000/文稿/qq/qq-farm-bot-ui-main/web/src/components/ui/BaseSwitch.vue)

- 新增 `hint` (string) 和 `recommend` ('on' | 'off' | 'conditional') 可选 prop
- 当 `hint` 存在时，在 label 文字右侧渲染一个 `ⓘ` 小图标
- 鼠标悬停 `ⓘ` 时显示 CSS tooltip 气泡，内容为 `hint` 文字 + 推荐建议标签
- `recommend` 控制推荐标签颜色：`on` 绿色、`off` 红色、`conditional` 橙色

#### [MODIFY] [Settings.vue](file:///Volumes/My Shared Files/AllFiles/Users/smdk000/文稿/qq/qq-farm-bot-ui-main/web/src/views/Settings.vue)

- 为全部 18 个 `<BaseSwitch>` 追加 `:hint` 和 `:recommend` 属性
- 为施肥策略的 `<BaseSelect>` 外层追加 `title` 属性

---

## 三、你可能没有考虑到的额外发现

### 1. ⚠️ 「自动购买化肥」`fertilizer_buy` 无消费上限保护
- **风险**：后端自动购买化肥时没有设定每日花费上限或库存阈值。如果配合「60秒防偷」大量消耗化肥，可能导致金币被无限购买化肥耗尽。
- **建议**：可追加一个「化肥购买上限/日」输入框，限制每日最大购买次数。

### 2. ⚠️ 施肥策略下拉缺少 Tooltip 解释
- 四个选项（普通+有机 / 仅普通 / 仅有机 / 不施肥）之间的差异对新用户不直观。
- **建议**：给下拉选项追加 `description` 小字说明。

### 3. 💡 分组标题也可以加 Tooltip
- 「农场基础操作」「每日收益领取」「化肥与精细控制」「社交互动详细策略」四个分组标题本身也缺少说明。
- **建议**：可以在分组标题旁同样添加 `ⓘ` 图标，解释该分组的整体作用。

### 4. 💡 推荐标签可以配合预设模板联动
- 三种预设（保守/平衡/激进）已有各自的推荐开关组合。
- **建议**：Tooltip 中的推荐建议可以标注「保守预设: 开 | 激进预设: 开」风格的多维度建议。

---

## 四、验证方案

### 浏览器手动验证
1. 启动前端 (`pnpm dev:web`) 并访问 `http://localhost:2800/settings`
2. 使用测试账号 `jsh` / `123456` 登录
3. 逐一将鼠标悬停到每个开关的 `ⓘ` 图标上，确认：
   - Tooltip 正确显示功能解释文字
   - 推荐标签颜色正确（绿/红/橙）
   - 深色模式下 Tooltip 可读性正常
   - 移动端（窄屏）下不会溢出屏幕
