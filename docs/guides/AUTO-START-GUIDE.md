# ğŸš€ æ— æ„ŸçŸ¥è‡ªåŠ¨å¯åŠ¨é…ç½®æŒ‡å—

## âœ… å·²å®ç°çš„è‡ªåŠ¨åŒ–åŠŸèƒ½

### 1. è¿›ç¨‹å®ˆæŠ¤
- âœ… è‡ªåŠ¨å¯åŠ¨ OpenViking Python æœåŠ¡
- âœ… è¿›ç¨‹å´©æºƒè‡ªåŠ¨é‡å¯ï¼ˆæœ€å¤š 5 æ¬¡ï¼‰
- âœ… å®šæœŸå¥åº·æ£€æŸ¥ï¼ˆ30 ç§’é—´éš”ï¼‰
- âœ… æ•…éšœè‡ªåŠ¨æ¢å¤

### 2. æ— æ„ŸçŸ¥é›†æˆ
- âœ… é›†æˆåˆ°ä¸»ç¨‹åºå¯åŠ¨æµç¨‹
- âœ… åå°é™é»˜è¿è¡Œ
- âœ… ä¸é˜»å¡ä¸»ç¨‹åº
- âœ… å¤±è´¥ä¸å½±å“ä¸»åŠŸèƒ½

### 3. å¼€æœºè‡ªå¯åŠ¨
- âœ… macOS launchd æ”¯æŒ
- âœ… Linux systemd æ”¯æŒ
- âœ… Windows NSSM æ”¯æŒ

## ğŸ“‹ è‡ªåŠ¨å¯åŠ¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å¯åŠ¨ä¸»ç¨‹åº (npm start)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   core/client.js è‡ªåŠ¨è°ƒç”¨ ai-autostart.start()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ai-autostart.js æ£€æŸ¥å®ˆæŠ¤è¿›ç¨‹æ˜¯å¦è¿è¡Œ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¦‚æœæœªè¿è¡Œï¼šå¯åŠ¨ ai-services-daemon.js            â”‚
â”‚   å¦‚æœå·²è¿è¡Œï¼šè·³è¿‡å¯åŠ¨                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ai-services-daemon.js æ‰§è¡Œï¼š                      â”‚
â”‚   1. åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœéœ€è¦ï¼‰               â”‚
â”‚   2. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰                           â”‚
â”‚   3. å¯åŠ¨ OpenViking Flask æœåŠ¡                     â”‚
â”‚   4. å¯åŠ¨å¥åº·æ£€æŸ¥å¾ªç¯                               â”‚
â”‚   5. ç›‘æ§è¿›ç¨‹çŠ¶æ€ï¼Œæ•…éšœè‡ªåŠ¨é‡å¯                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1ï¼šæ­£å¸¸å¯åŠ¨ï¼ˆæ¨èï¼‰

**æ— éœ€ä»»ä½•é¢å¤–æ“ä½œï¼**

```bash
# åƒå¾€å¸¸ä¸€æ ·å¯åŠ¨é¡¹ç›®
npm start

# æˆ–è€…
cd core
npm start
```

AI æœåŠ¡ä¼šè‡ªåŠ¨åœ¨åå°å¯åŠ¨ï¼Œå®Œå…¨æ— æ„ŸçŸ¥ï¼

### æ–¹å¼ 2ï¼šæ‰‹åŠ¨æ§åˆ¶

```bash
# æŸ¥çœ‹çŠ¶æ€
node ai-autostart.js status

# å¯åŠ¨æœåŠ¡
node ai-autostart.js start

# åœæ­¢æœåŠ¡
node ai-autostart.js stop

# é‡å¯æœåŠ¡
node ai-autostart.js restart
```

## ğŸŒ å¼€æœºè‡ªå¯åŠ¨é…ç½®

### macOS

```bash
# 1. è¿è¡Œé…ç½®è„šæœ¬
chmod +x setup-macos-launchd.sh
./setup-macos-launchd.sh

# 2. åŠ è½½æœåŠ¡
launchctl load -w ~/Library/LaunchAgents/com.qqfarm.ai-services.plist

# 3. éªŒè¯
launchctl list | grep com.qqfarm.ai-services
```

**å¸è½½æ–¹æ³•ï¼š**
```bash
launchctl unload -w ~/Library/LaunchAgents/com.qqfarm.ai-services.plist
```

### Linux (systemd)

```bash
# 1. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆä¿®æ”¹ç”¨æˆ·åå’Œè·¯å¾„ï¼‰
sudo nano /etc/systemd/system/ai-services.service

# 2. é‡æ–°åŠ è½½ systemd
sudo systemctl daemon-reload

# 3. å¯ç”¨æœåŠ¡
sudo systemctl enable ai-services

# 4. å¯åŠ¨æœåŠ¡
sudo systemctl start ai-services

# 5. æŸ¥çœ‹çŠ¶æ€
systemctl status ai-services
```

**æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
journalctl -u ai-services -f
```

### Windows

ä½¿ç”¨ NSSM (Non-Sucking Service Manager)ï¼š

```bash
# 1. ä¸‹è½½ NSSM: https://nssm.cc/download

# 2. å®‰è£…æœåŠ¡
nssm install AI-Services

# 3. é…ç½®æœåŠ¡ï¼ˆå›¾å½¢ç•Œé¢ï¼‰
# - Application: node.exe
# - Arguments: ai-services-daemon.js
# - Startup directory: é¡¹ç›®æ ¹ç›®å½•

# 4. å¯åŠ¨æœåŠ¡
nssm start AI-Services
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

**Web é¢æ¿ï¼ˆé›†æˆåˆ°ç°æœ‰é¢æ¿ï¼‰ï¼š**
```
GET /api/ai/status    # æŸ¥çœ‹ AI æœåŠ¡çŠ¶æ€
GET /api/ai/logs      # æŸ¥çœ‹æ—¥å¿—
POST /api/ai/restart  # é‡å¯æœåŠ¡
```

**å‘½ä»¤è¡Œï¼š**
```bash
# æŸ¥çœ‹çŠ¶æ€
node ai-autostart.js status

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/ai-services.log
tail -f logs/ai-services-error.log
```

### æ—¥å¿—æ–‡ä»¶ä½ç½®

```
logs/
â”œâ”€â”€ ai-services.log          # ä¸»æ—¥å¿—
â”œâ”€â”€ ai-services-error.log    # é”™è¯¯æ—¥å¿—
â”œâ”€â”€ ai-autostart.log         # è‡ªåŠ¨å¯åŠ¨æ—¥å¿—
â””â”€â”€ ai-daemon.pid            # å®ˆæŠ¤è¿›ç¨‹ PID
```

## âš™ï¸ é…ç½®é€‰é¡¹

åœ¨ `ai-services-daemon.js` ä¸­å¯é…ç½®ï¼š

```javascript
const CONFIG = {
  openVikingPort: 5000,              // OpenViking ç«¯å£
  openVikingUrl: 'http://localhost:5000',
  restartDelay: 3000,                // é‡å¯å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
  healthCheckInterval: 30000,        // å¥åº·æ£€æŸ¥é—´éš”ï¼ˆæ¯«ç§’ï¼‰
  maxRestarts: 5,                    // æœ€å¤§é‡å¯æ¬¡æ•°
  healthCheckTimeout: 5000,          // å¥åº·æ£€æŸ¥è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
};
```

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šAI æœåŠ¡æœªè‡ªåŠ¨å¯åŠ¨

**æ£€æŸ¥ä¸»ç¨‹åºæ—¥å¿—ï¼š**
```bash
tail -f logs/ai-autostart.log
```

**æ‰‹åŠ¨æµ‹è¯•å¯åŠ¨ï¼š**
```bash
node ai-autostart.js start
```

### é—®é¢˜ 2ï¼šå®ˆæŠ¤è¿›ç¨‹åå¤é‡å¯

**æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š**
```bash
tail -f logs/ai-services-error.log
```

**å¸¸è§åŸå› ï¼š**
- Python è™šæ‹Ÿç¯å¢ƒæœªåˆ›å»º
- ä¾èµ–æœªå®‰è£…
- ç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ‰‹åŠ¨åˆå§‹åŒ–
cd openviking-service
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### é—®é¢˜ 3ï¼šOpenViking æœåŠ¡æ— æ³•è®¿é—®

**æ£€æŸ¥å¥åº·çŠ¶æ€ï¼š**
```bash
curl http://localhost:5000/health
```

**æŸ¥çœ‹è¿›ç¨‹ï¼š**
```bash
ps aux | grep "python.*app.py"
```

**é‡å¯æœåŠ¡ï¼š**
```bash
node ai-autostart.js restart
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### é™ä½èµ„æºå ç”¨

é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ï¼š

```javascript
// macOS launchd
<key>LowPriorityIO</key>
<true/>
<key>Nice</key>
<integer>10</integer>

// Linux systemd
Nice=10
IOSchedulingClass=idle
```

### è°ƒæ•´å¥åº·æ£€æŸ¥é¢‘ç‡

```javascript
// é™ä½æ£€æŸ¥é¢‘ç‡ï¼ˆé»˜è®¤ 30 ç§’ï¼‰
healthCheckInterval: 60000  // æ”¹ä¸º 60 ç§’

// æˆ–æé«˜æ£€æŸ¥é¢‘ç‡
healthCheckInterval: 15000  // æ”¹ä¸º 15 ç§’
```

## ğŸ¯ éªŒè¯è‡ªåŠ¨åŒ–

### æµ‹è¯•æ­¥éª¤

1. **å¯åŠ¨ä¸»ç¨‹åº**
   ```bash
   npm start
   ```

2. **ç­‰å¾… 10 ç§’**

3. **æ£€æŸ¥ AI æœåŠ¡çŠ¶æ€**
   ```bash
   node ai-autostart.js status
   # åº”è¯¥æ˜¾ç¤ºï¼šâœ… AI æœåŠ¡å®ˆæŠ¤è¿›ç¨‹æ­£åœ¨è¿è¡Œ
   
   curl http://localhost:5000/health
   # åº”è¯¥è¿”å›ï¼š{"status":"healthy","workspace":"..."}
   ```

4. **æµ‹è¯•è‡ªåŠ¨é‡å¯**
   ```bash
   # æ‰¾åˆ° OpenViking è¿›ç¨‹
   ps aux | grep "python.*app.py"
   
   # æ€æ­»è¿›ç¨‹
   kill -9 <PID>
   
   # ç­‰å¾… 5 ç§’ï¼Œæ£€æŸ¥æ˜¯å¦è‡ªåŠ¨é‡å¯
   curl http://localhost:5000/health
   ```

5. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   tail -f logs/ai-services.log
   ```

## âœ¨ ç‰¹æ€§æ€»ç»“

### å®Œå…¨æ— æ„ŸçŸ¥

- âœ… æ— éœ€æ‰‹åŠ¨å¯åŠ¨ AI æœåŠ¡
- âœ… æ— éœ€é¢å¤–é…ç½®
- âœ… å¤±è´¥ä¸å½±å“ä¸»ç¨‹åº
- âœ… åå°é™é»˜è¿è¡Œ

### é«˜åº¦å¯é 

- âœ… è¿›ç¨‹å´©æºƒè‡ªåŠ¨é‡å¯
- âœ… å®šæœŸå¥åº·æ£€æŸ¥
- âœ… æœ€å¤§é‡å¯æ¬¡æ•°é™åˆ¶
- âœ… è¯¦ç»†çš„æ—¥å¿—è®°å½•

### æ˜“äºç®¡ç†

- âœ… ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·
- âœ… Web é¢æ¿é›†æˆ
- âœ… å¼€æœºè‡ªå¯åŠ¨æ”¯æŒ
- âœ… å®Œæ•´çš„ç›‘æ§åŠŸèƒ½

### è·¨å¹³å°æ”¯æŒ

- âœ… macOS (launchd)
- âœ… Linux (systemd)
- âœ… Windows (NSSM)

## ğŸ‰ ä½¿ç”¨ç¤ºä¾‹

### æ—¥å¸¸ä½¿ç”¨

```bash
# å°±åƒå¾€å¸¸ä¸€æ ·å¯åŠ¨é¡¹ç›®
npm start

# ç„¶åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼
# AI æœåŠ¡å·²ç»åœ¨åå°è‡ªåŠ¨è¿è¡Œ
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨

```javascript
const { qwenAIAssistant } = require('./core/src/services/qwenAIAssistant');

// ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€æ‹…å¿ƒæœåŠ¡æ˜¯å¦å¯åŠ¨
const result = await qwenAIAssistant.generateCode(
  'åˆ›å»ºå¿«é€Ÿæ’åºå‡½æ•°',
  'javascript'
);
```

### æŸ¥çœ‹çŠ¶æ€

```bash
# å¿«é€ŸæŸ¥çœ‹
node ai-autostart.js status

# æˆ–è€…è®¿é—® Web é¢æ¿
# http://localhost:3000/api/ai/status
```

## ğŸ“ å¸®åŠ©

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š

1. æ—¥å¿—æ–‡ä»¶ï¼š`logs/ai-*.log`
2. ç³»ç»Ÿæ—¥å¿—ï¼š`journalctl -u ai-services` (Linux) æˆ– Console.app (macOS)
3. æ–‡æ¡£ï¼šREADME.AI.md

---

**ç°åœ¨ï¼Œä½ åªéœ€è¦åƒå¾€å¸¸ä¸€æ ·å¯åŠ¨é¡¹ç›®ï¼ŒAI æœåŠ¡å°±ä¼šè‡ªåŠ¨åœ¨åå°è¿è¡Œï¼** ğŸ‰
